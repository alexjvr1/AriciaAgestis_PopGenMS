# Creating SFS inputs with ANGSD

We decided to use Angsd for the SFS for Brown Argus because the ddRAD data is very gappy - i.e. there is a lot of missingness in the data. 

First compile a list of bamfiles for the individuals from the final dataset for the rest of the paper: BA261
```
on BlueCrystal

bluecp3:/newhome/aj18951/1a_Aricia_agestis_PopGenomics/ANGSD/BA261.bamlist
```

Then generate SFS for all indivs in the bamlist by parallelising across the regions in the genome (as defined by the regions file from previous variant calling analyses. 
Use [this](https://github.com/alexjvr1/AriciaAgestis_PopGenMS/blob/master/angsd.sfs.sh) script. 

The genome here has been split into 18 parts. So the SAF regions files need to be concatenated together: 

```
module load languages/gcc-6.1

~/bin/angsd/misc/realSFS cat BA.regionsab.saf.idx BA.regionsac.saf.idx -outnames testmerge
        -> This will cat together .saf files from angsd
	-> regions has to be disjoint between saf files. This WONT be checked (alot) !
	-> This has only been tested on safs for different chrs !
	-> Version of fname:BA.regionsab.saf.idx is:2
	-> Assuming .saf.gz file: BA.regionsab.saf.gz
	-> Assuming .saf.pos.gz: BA.regionsab.saf.pos.gz
	-> Version of fname:BA.regionsac.saf.idx is:2
	-> Assuming .saf.gz file: BA.regionsac.saf.gz
	-> Assuming .saf.pos.gz: BA.regionsac.saf.pos.gz
	-> outnames: 'testmerge' number of safs:2
	-> Merging 0/2 
	-> Merging 1/2 
  
~/bin/angsd/misc/realSFS cat BA.HOD.regionsaa.saf.idx BA.HOD.regionsab.saf.idx BA.HOD.regionsac.saf.idx BA.HOD.regionsad.saf.idx BA.HOD.regionsae.saf.idx BA.HOD.regionsaf.saf.idx BA.HOD.regionsag.saf.idx BA.HOD.regionsah.saf.idx BA.HOD.regionsai.saf.idx BA.HOD.regionsaj.saf.idx BA.HOD.regionsak.saf.idx BA.HOD.regionsal.saf.idx BA.HOD.regionsam.saf.idx BA.HOD.regionsan.saf.idx BA.HOD.regionsao.saf.idx BA.HOD.regionsap.saf.idx BA.HOD.regionsaq.saf.idx BA.HOD.regionsar.saf.idx -outnames BA.HOD.merge

~/bin/angsd/misc/realSFS cat BA.FOR.regionsaa.saf.idx BA.FOR.regionsab.saf.idx BA.FOR.regionsac.saf.idx BA.FOR.regionsad.saf.idx BA.FOR.regionsae.saf.idx BA.FOR.regionsaf.saf.idx BA.FOR.regionsag.saf.idx BA.FOR.regionsah.saf.idx BA.FOR.regionsai.saf.idx BA.FOR.regionsaj.saf.idx BA.FOR.regionsak.saf.idx BA.FOR.regionsal.saf.idx BA.FOR.regionsam.saf.idx BA.FOR.regionsan.saf.idx BA.FOR.regionsao.saf.idx BA.FOR.regionsap.saf.idx BA.FOR.regionsaq.saf.idx BA.FOR.regionsar.saf.idx -outnames BA.FOR.merge
```

And then a folded SFS can be created for each of the populations: 
```
~/bin/angsd/misc/realSFS testmerge.saf.idx -fold 1 > testmerge.saf.sfs

```

We need to create 2D+ SFS when using multiple populations. Test here how to make a 2D SFS with HOD and South: 
```
##2D folded SFS
~/bin/angsd/misc/realSFS BA.HOD.merge.saf.idx BA.FOR.merge.saf.idx -fold 1 > BA.HOD.FOR.2dSFS.sfs

```
