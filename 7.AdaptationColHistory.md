# Are there differences in individuals that colonised the new populations? 

Hypothesis: Initial colonisation of new sites may be driven by individuals that are better at dispersing. Are there loci associated with differences in population colonisation histories? 

## Rerun

I had to rerun this analysis with FOR classified as NEW rather than OLD/ESTABLISHED. 

This page shows the new results: 

### File locations: 

```
Server: 
/newhome/aj18951/1a_Aricia_agestis_PopGenomics/Bayescan/Out_perpop

Mac:
/Users/alexjvr/2018.postdoc/BrownArgus_2018/201902_DataAnalysis/Bayescan/ColHistory_FORnew_out
```


## Check for convergence

```
source("plot_R.r")
library(coda)

chain <- read.table("AA216.ColHistoryFORnew.baye.sel", header=T)
chain <- mcmc(chain, thin=10)

plot(chain)  ##check for convergence
summary(chain)


Iterations = 1:49981
Thinning interval = 10 
Number of chains = 1 
Sample size per chain = 4999 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

           Mean        SD  Naive SE Time-series SE
logL -2.229e+05 2.642e+02 3.736e+00      1.069e+01
Fst1  3.675e-02 4.182e-04 5.915e-06      8.474e-06
Fst2  1.172e-02 3.267e-04 4.620e-06      1.302e-05

2. Quantiles for each variable:

           2.5%        25%        50%        75%      97.5%
logL -2.234e+05 -2.230e+05 -2.229e+05 -2.227e+05 -2.223e+05
Fst1  3.591e-02  3.647e-02  3.675e-02  3.702e-02  3.755e-02
Fst2  1.108e-02  1.150e-02  1.171e-02  1.194e-02  1.238e-02


autocorr.diag(chain) ## check correlation between the chains. Make sure the chains didn't get stuck

               logL        Fst1        Fst2
Lag 0    1.00000000  1.00000000  1.00000000
Lag 10   0.68964040  0.34477057  0.76578701
Lag 50   0.30215042  0.03714750  0.28398740
Lag 100  0.12432969  0.01062740  0.08582002
Lag 500 -0.02056128 -0.01034404 -0.04557796


effectiveSize(chain) ##check that this is close to the sample size (here 5000). If there is correlation (chain got stuck) the sample size will be much smaller than the input
     logL      Fst1      Fst2 
 610.6652 2435.2381  629.4086 

geweke.diag(chain, frac1=0.1, frac2=0.5)  ##The diagnostic reports the z-scores for each parameter. For example, with α = 0.05, the critical values of z are – 1.96 and +1.96. We reject H0 (equality of means => convergence) if z < -1.96 or z > +1.96.

Fraction in 1st window = 0.1
Fraction in 2nd window = 0.5 

   logL    Fst1    Fst2 
 0.2026 -1.3674 -0.4195
 
 

heidel.diag(chain, eps=0.1, pvalue=0.05) ##another test whether the chains have reached stationarity. 

     Stationarity start     p-value
     test         iteration        
logL passed       1         0.332  
Fst1 passed       1         0.302  
Fst2 passed       1         0.988  
                                  
     Halfwidth Mean      Halfwidth
     test                         
logL passed    -2.23e+05 2.10e+01 
Fst1 passed     3.67e-02 1.66e-05 
Fst2 passed     1.17e-02 2.55e-05 

```

![alt_txt][FORnew_convergence]

[FORnew_convergence]:https://user-images.githubusercontent.com/12142475/85390002-1a2e5580-b540-11ea-9565-b4a46927a7be.png



## Outliers


```
AA.results <- read.table("AA216.ColHistoryFORnew.baye_fst.txt")

pdf("AA.ColHistFORnew.bayescan.results")
par(mfrow=c(1,2))
plot_bayescan(AA.results, FDR=0.05, add_text=T)
plot_bayescan(AA.results, FDR=0.01, add_text=T)
dev.off()


plot_bayescan(AA.results, FDR=0.05, add_text=T)
$outliers
 [1] 10847 11041 11050 12957 13829 13830 17567 21375 21377 21378 21379 27882
[13] 28329 28726 28728

$nb_outliers
[1] 15


> plot_bayescan(AA.results, FDR=0.01, add_text=T)
$outliers
[1] 13829 13830 27882

$nb_outliers
[1] 3


```





## Old Run


```
getwd()
/Users/alexjvr/2018.postdoc/BrownArgus_2018/201902_DataAnalysis/Bayescan/Out_Colonisation

chain <- read.table("AA216.ColHistory.baye.sel", header=T)
plot(chain)
summary(chain)

Iterations = 1:49981
Thinning interval = 10 
Number of chains = 1 
Sample size per chain = 4999 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

           Mean        SD  Naive SE Time-series SE
logL -2.162e+05 3.422e+02 4.840e+00      1.781e+01
Fst1  3.494e-02 3.876e-04 5.482e-06      7.797e-06
Fst2  7.232e-03 2.996e-04 4.237e-06      1.552e-05

2. Quantiles for each variable:

           2.5%        25%        50%        75%      97.5%
logL -2.169e+05 -2.164e+05 -2.162e+05 -2.160e+05 -2.156e+05
Fst1  3.419e-02  3.467e-02  3.493e-02  3.520e-02  3.570e-02
Fst2  6.669e-03  7.029e-03  7.227e-03  7.431e-03  7.827e-03



autocorr.diag(chain) ## check correlation between the chains. Make sure the chains didn't get stuck
              logL         Fst1       Fst2
Lag 0   1.00000000  1.000000000 1.00000000
Lag 10  0.80454360  0.257090617 0.84986634
Lag 50  0.47166941  0.034087400 0.49877477
Lag 100 0.24796989  0.021426989 0.24728633
Lag 500 0.01293802 -0.003159467 0.01075276

effectiveSize(chain) ##check that this is close to the sample size (here 5000). If there is correlation (chain got stuck) the sample size will be much smaller than the input
     logL      Fst1      Fst2 
 368.9711 2470.9021  372.8646 
 
 geweke.diag(chain, frac1=0.1, frac2=0.5)  ##The diagnostic reports the z-scores for each parameter. For example, with α = 0.05, the critical values of z are – 1.96 and +1.96. We reject H0 (equality of means => convergence) if z < -1.96 or z > +1.96.

Fraction in 1st window = 0.1
Fraction in 2nd window = 0.5 

   logL    Fst1    Fst2 
0.30718 0.48467 0.04779 

heidel.diag(chain, eps=0.1, pvalue=0.05) ##another test whether the chains have reached stationarity. 
                                   
     Stationarity start     p-value
     test         iteration        
logL passed       1         0.605  
Fst1 passed       1         0.604  
Fst2 passed       1         0.552  
                                  
     Halfwidth Mean      Halfwidth
     test                         
logL passed    -2.16e+05 3.49e+01 
Fst1 passed     3.49e-02 1.53e-05 
Fst2 passed     7.23e-03 3.04e-05 
```


![alt_txt][ColHistOld]

[ColHistOld]:https://user-images.githubusercontent.com/12142475/85391203-c7559d80-b541-11ea-85b1-c1159c808b24.png



Plot cut-off for outliers
```
AA.results <- read.table("AA216.ColHistory.baye_fst.txt")

pdf("AA216.ColHistory.bayescan.results.pdf")
par(mfrow=c(1,2))
plot_bayescan(AA.results, FDR=0.05, add_text=T)
plot_bayescan(AA.results, FDR=0.01, add_text=T)
dev.off()


plot_bayescan(AA.results, FDR=0.05, add_text=T)
$outliers
 [1]  8878 11050 12957 13829 13830 17001 17567 18089 21375 21378 27882 28329
[13] 28726 28728

$nb_outliers
[1] 14


> plot_bayescan(AA.results, FDR=0.01, add_text=T)
$outliers
[1]  8878 12957 28329 28726 28728

$nb_outliers
[1] 5

```
