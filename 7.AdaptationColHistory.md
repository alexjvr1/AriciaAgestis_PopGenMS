# Are there differences in individuals that colonised the new populations? 

Hypothesis: Initial colonisation of new sites may be driven by individuals that are better at dispersing. Are there loci associated with differences in population colonisation histories? 

## Rerun

I had to rerun this analysis with FOR classified as NEW rather than OLD/ESTABLISHED. 

This page shows the new results: 

### File locations: 

```
Server: 
/newhome/aj18951/1a_Aricia_agestis_PopGenomics/Bayescan/Out_perpop

Mac:
/Users/alexjvr/2018.postdoc/BrownArgus_2018/201902_DataAnalysis/Bayescan
```


## Check for convergence

```
source("plot_R.r")
library(coda)

chain <- read.table("AA251.ColHist.baye.sel", header=T)
chain <- mcmc(chain, thin=10)

plot(chain)  ##check for convergence
summary(chain)


Iterations = 1:49981
Thinning interval = 10 
Number of chains = 1 
Sample size per chain = 4999 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

           Mean        SD  Naive SE Time-series SE
logL -2.741e+05 2.595e+02 3.670e+00      1.128e+01
Fst1  1.277e-02 4.491e-04 6.352e-06      2.630e-05
Fst2  2.232e-02 4.684e-04 6.625e-06      2.356e-05

2. Quantiles for each variable:

           2.5%        25%        50%        75%      97.5%
logL -2.746e+05 -2.743e+05 -2.741e+05 -2.739e+05 -2.736e+05
Fst1  1.191e-02  1.247e-02  1.277e-02  1.306e-02  1.368e-02
Fst2  2.140e-02  2.201e-02  2.232e-02  2.263e-02  2.325e-02


autocorr.diag(chain) ## check correlation between the chains. Make sure the chains didn't get stuck

                logL        Fst1        Fst2
Lag 0    1.000000000  1.00000000 1.000000000
Lag 10   0.625159724  0.87036443 0.740364647
Lag 50   0.334031585  0.57280745 0.425247669
Lag 100  0.185569709  0.31189495 0.230250266
Lag 500 -0.002541462 -0.01063002 0.005459489


effectiveSize(chain) ##check that this is close to the sample size (here 5000). If there is correlation (chain got stuck) the sample size will be much smaller than the input
    logL     Fst1     Fst2 
529.4070 291.4587 395.4046 

geweke.diag(chain, frac1=0.1, frac2=0.5)  ##The diagnostic reports the z-scores for each parameter. For example, with α = 0.05, the critical values of z are – 1.96 and +1.96. We reject H0 (equality of means => convergence) if z < -1.96 or z > +1.96.

Fraction in 1st window = 0.1
Fraction in 2nd window = 0.5 

  logL    Fst1    Fst2 
-1.1806  0.6108 -0.5149 
 
 

heidel.diag(chain, eps=0.1, pvalue=0.05) ##another test whether the chains have reached stationarity. 

     Stationarity start     p-value
     test         iteration        
logL passed       1         0.461  
Fst1 passed       1         0.285  
Fst2 passed       1         0.204  
                                  
     Halfwidth Mean      Halfwidth
     test                         
logL passed    -2.74e+05 2.21e+01 
Fst1 passed     1.28e-02 5.16e-05 
Fst2 passed     2.23e-02 4.62e-05 

```

![alt_txt][FORnew_convergence]

[FORnew_convergence]:



## Outliers


```
AA.ColHist.results <- read.table("AA251.ColHist.baye_fst.txt")

pdf("AA.ColHist.bayescan.results")
par(mfrow=c(1,2))
plot_bayescan(AA.ColHist.results, FDR=0.05, add_text=T)
plot_bayescan(AA.ColHist.results, FDR=0.01, add_text=T)
dev.off()


plot_bayescan(AA.ColHist.results, FDR=0.05, add_text=T)
$outliers
 [1]   697   698   700   701   702  1059  1196  1199  2530  4513  4514  6205
[13] 10819 11200 12145 12405 12413 12414 14062 14726 14727 14730 16019 17041
[25] 18124 20759 21106 21116 25257 27621 29143 34306

$nb_outliers
[1] 32

plot_bayescan(AA.ColHist.results, FDR=0.01, add_text=T)
$outliers
 [1]   697   698   700   701   702  1059 12405 12413 12414 14726 14730 16019
[13] 18124 21116 34306

$nb_outliers
[1] 15



```





## Old Run


```
getwd()
/Users/alexjvr/2018.postdoc/BrownArgus_2018/201902_DataAnalysis/Bayescan/Out_Colonisation

chain <- read.table("AA216.ColHistory.baye.sel", header=T)
plot(chain)
summary(chain)

Iterations = 1:49981
Thinning interval = 10 
Number of chains = 1 
Sample size per chain = 4999 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

           Mean        SD  Naive SE Time-series SE
logL -2.162e+05 3.422e+02 4.840e+00      1.781e+01
Fst1  3.494e-02 3.876e-04 5.482e-06      7.797e-06
Fst2  7.232e-03 2.996e-04 4.237e-06      1.552e-05

2. Quantiles for each variable:

           2.5%        25%        50%        75%      97.5%
logL -2.169e+05 -2.164e+05 -2.162e+05 -2.160e+05 -2.156e+05
Fst1  3.419e-02  3.467e-02  3.493e-02  3.520e-02  3.570e-02
Fst2  6.669e-03  7.029e-03  7.227e-03  7.431e-03  7.827e-03



autocorr.diag(chain) ## check correlation between the chains. Make sure the chains didn't get stuck
              logL         Fst1       Fst2
Lag 0   1.00000000  1.000000000 1.00000000
Lag 10  0.80454360  0.257090617 0.84986634
Lag 50  0.47166941  0.034087400 0.49877477
Lag 100 0.24796989  0.021426989 0.24728633
Lag 500 0.01293802 -0.003159467 0.01075276

effectiveSize(chain) ##check that this is close to the sample size (here 5000). If there is correlation (chain got stuck) the sample size will be much smaller than the input
     logL      Fst1      Fst2 
 368.9711 2470.9021  372.8646 
 
 geweke.diag(chain, frac1=0.1, frac2=0.5)  ##The diagnostic reports the z-scores for each parameter. For example, with α = 0.05, the critical values of z are – 1.96 and +1.96. We reject H0 (equality of means => convergence) if z < -1.96 or z > +1.96.

Fraction in 1st window = 0.1
Fraction in 2nd window = 0.5 

   logL    Fst1    Fst2 
0.30718 0.48467 0.04779 

heidel.diag(chain, eps=0.1, pvalue=0.05) ##another test whether the chains have reached stationarity. 
                                   
     Stationarity start     p-value
     test         iteration        
logL passed       1         0.605  
Fst1 passed       1         0.604  
Fst2 passed       1         0.552  
                                  
     Halfwidth Mean      Halfwidth
     test                         
logL passed    -2.16e+05 3.49e+01 
Fst1 passed     3.49e-02 1.53e-05 
Fst2 passed     7.23e-03 3.04e-05 
```


![alt_txt][ColHistOld]

[ColHistOld]:https://user-images.githubusercontent.com/12142475/85391203-c7559d80-b541-11ea-85b1-c1159c808b24.png



Plot cut-off for outliers
```
AA.results <- read.table("AA216.ColHistory.baye_fst.txt")

pdf("AA216.ColHistory.bayescan.results.pdf")
par(mfrow=c(1,2))
plot_bayescan(AA.results, FDR=0.05, add_text=T)
plot_bayescan(AA.results, FDR=0.01, add_text=T)
dev.off()


plot_bayescan(AA.results, FDR=0.05, add_text=T)
$outliers
 [1]  8878 11050 12957 13829 13830 17001 17567 18089 21375 21378 27882 28329
[13] 28726 28728

$nb_outliers
[1] 14


> plot_bayescan(AA.results, FDR=0.01, add_text=T)
$outliers
[1]  8878 12957 28329 28726 28728

$nb_outliers
[1] 5

```
