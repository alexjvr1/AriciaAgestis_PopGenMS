# Resampled input files using easySFS

The ddRAD dataset is gappy - although the libraries have all been sequenced to a good depth, the insert size range did not exactly overlap between libraries.

The final filtered dataset comprises ~35k loci. If I filter for 1 SNP per RAD locus this decreases to ~3.5k. 

As we need at least 8000 loci (according to Vitor Sousa and Laurent Excoffier) for an accurate estimate of the SFS, I will downsample each locus using the [easySFS](https://github.com/isaacovercast/easySFS) script from Isaac Overcast. 

I'm doing this on the server, so make use of the installed packages rather than local installation: 
```
/newhome/aj18951/1a_Aricia_agestis_PopGenomics/FastSimCoal/GENERATE_INPUT

module load languages/python-anaconda3-2019.10

#configure the shell to use 'conda activate'

conda init bash

#restart the server

#activate the environment

conda activate easySFS

conda create -n easySFS 
conda activate easySFS
conda install -c bioconda dadi pandas

cd easySFS
chmod u+x easySFS.py
./easySFS.py

usage: easySFS.py [-h] [-a] -i VCF_NAME -p POPULATIONS [--proj PROJECTIONS]
                  [--preview] [-o OUTDIR] [--ploidy PLOIDY] [--prefix PREFIX]
                  [--unfolded] [--dtype DTYPE] [--GQ GQUAL] [-f] [-v]

optional arguments:
  -h, --help          show this help message and exit
  -a             .....
  ...
  
```

Create the input files: 

1. popfile

2. vcf filtered for minDP 10 and no MAF filter

```
head FOR.HOD.names.txt
FOR_11_2014	FOR
FOR_12_2014	FOR
FOR_13_2014	FOR
FOR_14_2014	FOR

```

And run easySFS in --preview to see the number of loci when projecting down. 

```
./easySFS.py -i ../Scripts_VCFtoSFS_VitorSousa/HOD.FOR.recode.vcf -p FOR.HOD.names.txt --preview
Processing 2 populations - odict_keys(['FOR', 'HOD'])
  Sampling one snp per locus

    Running preview mode. We will print out the results for # of segregating sites
    for multiple values of projecting down for each population. The dadi
    manual recommends maximizing the # of seg sites for projections, but also
    a balance must be struck between # of seg sites and sample size.

    For each population you should choose the value of the projection that looks
    best and then rerun easySFS with the `--proj` flag.
    
FOR
(2, 593.0)	(3, 890.0)	(4, 1090.0)	(5, 1241.0)	(6, 1362.0)	(7, 1463.0)	(8, 1549.0)	(9, 1624.0)	(10, 1690.0)	(11, 1748.0)	(12, 1800.0)	(13, 1848.0)	(14, 1890.0)	(15, 1930.0)	(16, 1966.0)	(17, 1999.0)	(18, 2029.0)	(19, 2057.0)	(20, 2084.0)	(21, 2036.0)	(22, 2059.0)	(23, 1971.0)	(24, 1990.0)	(25, 1903.0)	(26, 1919.0)	(27, 1817.0)	(28, 1830.0)	(29, 1706.0)	(30, 1717.0)	(31, 1542.0)	(32, 1552.0)	(33, 1365.0)	(34, 1373.0)	(35, 1148.0)	(36, 1153.0)	(37, 874.0)	(38, 878.0)	(39, 522.0)	(40, 525.0)	


HOD
(2, 605.0)	(3, 907.0)	(4, 1115.0)	(5, 1277.0)	(6, 1408.0)	(7, 1519.0)	(8, 1615.0)	(9, 1699.0)	(10, 1772.0)	(11, 1838.0)	(12, 1898.0)	(13, 1951.0)	(14, 2000.0)	(15, 2045.0)	(16, 2086.0)	(17, 2124.0)	(18, 2159.0)	(19, 2191.0)	(20, 2222.0)	(21, 2250.0)	(22, 2277.0)	(23, 2302.0)	(24, 2325.0)	(25, 2347.0)	(26, 2368.0)	(27, 2388.0)	(28, 2407.0)	(29, 2425.0)	(30, 2442.0)	(31, 2452.0)	(32, 2467.0)	(33, 2473.0)	(34, 2487.0)	(35, 2485.0)	(36, 2497.0)	(37, 2491.0)	(38, 2503.0)	(39, 2475.0)	(40, 2486.0)	(41, 2463.0)	(42, 2473.0)	(43, 2434.0)	(44, 2443.0)	(45, 2383.0)	(46, 2391.0)	(47, 2307.0)	(48, 2314.0)	(49, 2199.0)	(50, 2205.0)	(51, 2076.0)	(52, 2082.0)	(53, 1913.0)	(54, 1918.0)	(55, 1728.0)	(56, 1732.0)	(57, 1445.0)	(58, 1448.0)	(59, 1029.0)	(60, 1031.0)

```


Select the projection that's the best compromise between number of loci and number of individuals. 

```
./easySFS.py -i ../Scripts_VCFtoSFS_VitorSousa/HOD.FOR.recode.vcf -p FOR.HOD.names.txt --proj 22,38
Processing 2 populations - odict_keys(['FOR', 'HOD'])
  Sampling one snp per locus
Doing 1D sfs - FOR
Doing 1D sfs - HOD
Doing 2D sfs - ('FOR', 'HOD')
Doing multiSFS for all pops
```

### INPUT VCF

I'm using the final vcf file before the MAF 0.01 filter

```
vcftools --vcf AA261.recode.vcf --minQ 100 --min-meanDP 10 --max-meanDP 255 --max-alleles 2 --max-missing 0.5

VCFtools - v0.1.12b
(C) Adam Auton and Anthony Marcketta 2009

Parameters as interpreted:
	--vcf AA261.recode.vcf
	--max-alleles 2
	--max-meanDP 255
	--min-meanDP 10
	--minQ 100
	--max-missing 0.5

After filtering, kept 261 out of 261 Individuals
After filtering, kept 58483 out of a possible 63054 Sites
Run Time = 7.00 seconds

vcftools --vcf AA261.FSCinput.recode.vcf --thin 600

VCFtools - v0.1.12b
(C) Adam Auton and Anthony Marcketta 2009

Parameters as interpreted:
	--vcf AA261.FSCinput.recode.vcf
	--thin 600

After filtering, kept 261 out of 261 Individuals
After filtering, kept 4860 out of a possible 58483 Sites
Run Time = 1.00 seconds

```

There seem to be a lot more independent loci in this dataset than before. I'm not using the --thin filter, but rather using easySFS to randomly sample a SNP per locus for the final SFS.  


### 1. Generate inputs for base model

We're first estimating the base model. i.e. what is the most likely colonisation scenario of the older populations (SOUTH, HOD, and FOR). 

Modify the pop file input and estimate the SFS for these three populations: 

```
bluecp3:/newhome/aj18951/1a_Aricia_agestis_PopGenomics/FastSimCoal/GENERATE_INPUT/easySFS/

popfile: noMAF.BaseModel.popinput
```

preview
```
module load languages/python-anaconda3-2019.10
conda activate easySFS

./easySFS.py -i AA.BaseModel.recode.vcf -p BaseModel.popinput --preview

Processing 3 populations - odict_keys(['SOUTH', 'FOR', 'HOD'])
  Sampling one snp per locus

    Running preview mode. We will print out the results for # of segregating sites
    for multiple values of projecting down for each population. The dadi
    manual recommends maximizing the # of seg sites for projections, but also
    a balance must be struck between # of seg sites and sample size.

    For each population you should choose the value of the projection that looks
    best and then rerun easySFS with the `--proj` flag.
    
SOUTH
(2, 516.0)	(3, 774.0)	(4, 955.0)	(5, 1098.0)	(6, 1217.0)	(7, 1319.0)	(8, 1409.0)	(9, 1489.0)	(10, 1562.0)	(11, 1627.0)	(12, 1688.0)	(13, 1744.0)	(14, 1796.0)	(15, 1844.0)	(16, 1889.0)	(17, 1932.0)	(18, 1972.0)	(19, 2010.0)	(20, 2046.0)	(21, 2080.0)	(22, 2113.0)	(23, 2144.0)	(24, 2174.0)	(25, 2203.0)	(26, 2230.0)	(27, 2257.0)	(28, 2282.0)	(29, 2307.0)	(30, 2330.0)	(31, 2353.0)	(32, 2375.0)	(33, 2397.0)	(34, 2418.0)	(35, 2438.0)	(36, 2457.0)	(37, 2476.0)	(38, 2495.0)	(39, 2512.0)	(40, 2530.0)	(41, 2547.0)	(42, 2563.0)	(43, 2580.0)	(44, 2595.0)	(45, 2611.0)	(46, 2626.0)	(47, 2640.0)	(48, 2655.0)	(49, 2669.0)	(50, 2682.0)	(51, 2696.0)	(52, 2709.0)	(53, 2722.0)	(54, 2734.0)	(55, 2747.0)	(56, 2759.0)	(57, 2770.0)	(58, 2782.0)	(59, 2794.0)	(60, 2805.0)	(61, 2816.0)	(62, 2826.0)	(63, 2837.0)	(64, 2847.0)	(65, 2857.0)	(66, 2867.0)	(67, 2877.0)	(68, 2886.0)	(69, 2896.0)	(70, 2905.0)	(71, 2914.0)	(72, 2923.0)	(73, 2931.0)	(74, 2940.0)	(75, 2947.0)	(76, 2955.0)	(77, 2964.0)	(78, 2972.0)	(79, 2975.0)	(80, 2983.0)	(81, 2989.0)	(82, 2997.0)	(83, 3002.0)	(84, 3010.0)	(85, 3014.0)	(86, 3022.0)	(87, 3026.0)	(88, 3033.0)	(89, 3032.0)	(90, 3039.0)	(91, 3039.0)	(92, 3046.0)	(93, 3045.0)	(94, 3052.0)	(95, 3047.0)	(96, 3054.0)	(97, 3047.0)	(98, 3053.0)	(99, 3046.0)	(100, 3052.0)	(101, 3040.0)	(102, 3046.0)	(103, 3037.0)	(104, 3042.0)	(105, 3034.0)	(106, 3039.0)	(107, 3030.0)	(108, 3035.0)	(109, 3022.0)	(110, 3028.0)	(111, 3020.0)	(112, 3025.0)	(113, 3001.0)	(114, 3006.0)	(115, 2995.0)	(116, 3000.0)	(117, 2971.0)	(118, 2976.0)	(119, 2956.0)	(120, 2961.0)	(121, 2940.0)	(122, 2945.0)	(123, 2918.0)	(124, 2922.0)	(125, 2905.0)	(126, 2909.0)	(127, 2884.0)	(128, 2888.0)	(129, 2866.0)	(130, 2870.0)	(131, 2845.0)	(132, 2849.0)	(133, 2828.0)	(134, 2832.0)	(135, 2805.0)	(136, 2808.0)	(137, 2785.0)	(138, 2789.0)	(139, 2760.0)	(140, 2764.0)	(141, 2742.0)	(142, 2745.0)	(143, 2720.0)	(144, 2723.0)	(145, 2704.0)	(146, 2708.0)	(147, 2676.0)	(148, 2679.0)	(149, 2641.0)	(150, 2645.0)	(151, 2603.0)	(152, 2606.0)	(153, 2571.0)	(154, 2574.0)	(155, 2538.0)	(156, 2541.0)	(157, 2504.0)	(158, 2507.0)	(159, 2468.0)	(160, 2471.0)	(161, 2432.0)	(162, 2435.0)	(163, 2389.0)	(164, 2392.0)	(165, 2349.0)	(166, 2352.0)	(167, 2300.0)	(168, 2303.0)	(169, 2261.0)	(170, 2264.0)	(171, 2217.0)	(172, 2219.0)	(173, 2170.0)	(174, 2172.0)	(175, 2104.0)	(176, 2106.0)	(177, 2022.0)	(178, 2024.0)	(179, 1939.0)	(180, 1941.0)	(181, 1848.0)	(182, 1850.0)	(183, 1757.0)	(184, 1759.0)	(185, 1644.0)	(186, 1645.0)	(187, 1498.0)	(188, 1499.0)	(189, 1336.0)	(190, 1337.0)	(191, 1124.0)	(192, 1125.0)	(193, 857.0)	(194, 858.0)	(195, 358.0)	(196, 358.0)	


FOR
(2, 487.0)	(3, 730.0)	(4, 893.0)	(5, 1016.0)	(6, 1114.0)	(7, 1193.0)	(8, 1262.0)	(9, 1318.0)	(10, 1371.0)	(11, 1402.0)	(12, 1444.0)	(13, 1460.0)	(14, 1495.0)	(15, 1494.0)	(16, 1524.0)	(17, 1490.0)	(18, 1514.0)	(19, 1470.0)	(20, 1491.0)	(21, 1419.0)	(22, 1436.0)	(23, 1351.0)	(24, 1366.0)	(25, 1277.0)	(26, 1289.0)	(27, 1202.0)	(28, 1212.0)	(29, 1111.0)	(30, 1119.0)	(31, 991.0)	(32, 998.0)	(33, 869.0)	(34, 875.0)	(35, 730.0)	(36, 734.0)	(37, 539.0)	(38, 541.0)	(39, 314.0)	(40, 315.0)	


HOD
(2, 499.0)	(3, 749.0)	(4, 920.0)	(5, 1053.0)	(6, 1162.0)	(7, 1254.0)	(8, 1334.0)	(9, 1404.0)	(10, 1467.0)	(11, 1523.0)	(12, 1574.0)	(13, 1620.0)	(14, 1663.0)	(15, 1701.0)	(16, 1738.0)	(17, 1769.0)	(18, 1801.0)	(19, 1826.0)	(20, 1853.0)	(21, 1876.0)	(22, 1900.0)	(23, 1914.0)	(24, 1936.0)	(25, 1939.0)	(26, 1958.0)	(27, 1959.0)	(28, 1977.0)	(29, 1968.0)	(30, 1984.0)	(31, 1965.0)	(32, 1979.0)	(33, 1949.0)	(34, 1962.0)	(35, 1926.0)	(36, 1938.0)	(37, 1892.0)	(38, 1902.0)	(39, 1853.0)	(40, 1863.0)	(41, 1805.0)	(42, 1814.0)	(43, 1744.0)	(44, 1752.0)	(45, 1676.0)	(46, 1683.0)	(47, 1590.0)	(48, 1596.0)	(49, 1492.0)	(50, 1498.0)	(51, 1393.0)	(52, 1399.0)	(53, 1255.0)	(54, 1259.0)	(55, 1126.0)	(56, 1130.0)	(57, 923.0)	(58, 926.0)	(59, 638.0)	(60, 640.0)
```

Generate the fastsimcoal input files: 
```
./easySFS.py -i AA.BaseModel.recode.vcf -p BaseModel.popinput --proj 83,16,28 -o BaseModel --prefix BaseModel -f

ls BaseModel/fastsimcoal2/
BaseModel_jointMAFpop1_0.obs  BaseModel_jointMAFpop2_1.obs  FOR_MAFpop0.obs  SOUTH_MAFpop0.obs
BaseModel_jointMAFpop2_0.obs  BaseModel_MSFS.obs            HOD_MAFpop0.obs
```


#### 2. Input for full model

```
./easySFS.py -i ~/1a_Aricia_agestis_PopGenomics/FINAL_VCF/AA261.FSCinput.recode.vcf -p FullModel.popinput --preview
Processing 4 populations - odict_keys(['NEW', 'SOUTH', 'FOR', 'HOD'])
  Sampling one snp per locus

    Running preview mode. We will print out the results for # of segregating sites
    for multiple values of projecting down for each population. The dadi
    manual recommends maximizing the # of seg sites for projections, but also
    a balance must be struck between # of seg sites and sample size.

    For each population you should choose the value of the projection that looks
    best and then rerun easySFS with the `--proj` flag.
    
NEW
(2, 480.0)	(3, 720.0)	(4, 884.0)	(5, 1011.0)	(6, 1114.0)	(7, 1201.0)	(8, 1277.0)	(9, 1343.0)	(10, 1403.0)	(11, 1456.0)	(12, 1505.0)	(13, 1550.0)	(14, 1591.0)	(15, 1629.0)	(16, 1665.0)	(17, 1698.0)	(18, 1730.0)	(19, 1759.0)	(20, 1787.0)	(21, 1813.0)	(22, 1838.0)	(23, 1862.0)	(24, 1885.0)	(25, 1906.0)	(26, 1927.0)	(27, 1947.0)	(28, 1966.0)	(29, 1984.0)	(30, 2002.0)	(31, 2019.0)	(32, 2035.0)	(33, 2051.0)	(34, 2066.0)	(35, 2081.0)	(36, 2095.0)	(37, 2109.0)	(38, 2122.0)	(39, 2135.0)	(40, 2148.0)	(41, 2160.0)	(42, 2172.0)	(43, 2184.0)	(44, 2195.0)	(45, 2206.0)	(46, 2217.0)	(47, 2227.0)	(48, 2237.0)	(49, 2247.0)	(50, 2257.0)	(51, 2266.0)	(52, 2276.0)	(53, 2285.0)	(54, 2293.0)	(55, 2302.0)	(56, 2311.0)	(57, 2319.0)	(58, 2327.0)	(59, 2335.0)	(60, 2343.0)	(61, 2350.0)	(62, 2358.0)	(63, 2365.0)	(64, 2372.0)	(65, 2379.0)	(66, 2386.0)	(67, 2393.0)	(68, 2400.0)	(69, 2406.0)	(70, 2413.0)	(71, 2419.0)	(72, 2425.0)	(73, 2431.0)	(74, 2437.0)	(75, 2443.0)	(76, 2449.0)	(77, 2455.0)	(78, 2460.0)	(79, 2466.0)	(80, 2471.0)	(81, 2476.0)	(82, 2482.0)	(83, 2487.0)	(84, 2492.0)	(85, 2497.0)	(86, 2502.0)	(87, 2506.0)	(88, 2511.0)	(89, 2515.0)	(90, 2520.0)	(91, 2523.0)	(92, 2528.0)	(93, 2529.0)	(94, 2534.0)	(95, 2537.0)	(96, 2541.0)	(97, 2545.0)	(98, 2549.0)	(99, 2553.0)	(100, 2557.0)	(101, 2559.0)	(102, 2563.0)	(103, 2561.0)	(104, 2564.0)	(105, 2567.0)	(106, 2571.0)	(107, 2569.0)	(108, 2572.0)	(109, 2569.0)	(110, 2572.0)	(111, 2567.0)	(112, 2570.0)	(113, 2569.0)	(114, 2572.0)	(115, 2560.0)	(116, 2563.0)	(117, 2559.0)	(118, 2562.0)	(119, 2555.0)	(120, 2558.0)	(121, 2551.0)	(122, 2554.0)	(123, 2547.0)	(124, 2550.0)	(125, 2541.0)	(126, 2544.0)	(127, 2532.0)	(128, 2535.0)	(129, 2523.0)	(130, 2526.0)	(131, 2509.0)	(132, 2511.0)	(133, 2499.0)	(134, 2502.0)	(135, 2491.0)	(136, 2494.0)	(137, 2478.0)	(138, 2481.0)	(139, 2467.0)	(140, 2470.0)	(141, 2451.0)	(142, 2454.0)	(143, 2442.0)	(144, 2444.0)	(145, 2431.0)	(146, 2433.0)	(147, 2420.0)	(148, 2423.0)	(149, 2398.0)	(150, 2400.0)	(151, 2385.0)	(152, 2387.0)	(153, 2359.0)	(154, 2362.0)	(155, 2337.0)	(156, 2339.0)	(157, 2315.0)	(158, 2317.0)	(159, 2301.0)	(160, 2303.0)	(161, 2278.0)	(162, 2279.0)	(163, 2260.0)	(164, 2262.0)	(165, 2236.0)	(166, 2238.0)	(167, 2222.0)	(168, 2224.0)	(169, 2202.0)	(170, 2204.0)	(171, 2177.0)	(172, 2178.0)	(173, 2148.0)	(174, 2150.0)	(175, 2128.0)	(176, 2130.0)	(177, 2103.0)	(178, 2104.0)	(179, 2077.0)	(180, 2078.0)	(181, 2048.0)	(182, 2049.0)	(183, 2020.0)	(184, 2021.0)	(185, 1994.0)	(186, 1995.0)	(187, 1977.0)	(188, 1979.0)	(189, 1954.0)	(190, 1955.0)	(191, 1920.0)	(192, 1921.0)	(193, 1884.0)	(194, 1886.0)	(195, 1851.0)	(196, 1852.0)	(197, 1810.0)	(198, 1811.0)	(199, 1774.0)	(200, 1776.0)	(201, 1733.0)	(202, 1734.0)	(203, 1683.0)	(204, 1684.0)	(205, 1630.0)	(206, 1631.0)	(207, 1573.0)	(208, 1574.0)	(209, 1517.0)	(210, 1518.0)	(211, 1446.0)	(212, 1447.0)	(213, 1367.0)	(214, 1368.0)	(215, 1305.0)	(216, 1305.0)	(217, 1197.0)	(218, 1198.0)	(219, 1109.0)	(220, 1110.0)	(221, 974.0)	(222, 975.0)	(223, 762.0)	(224, 763.0)	(225, 304.0)	(226, 304.0)	


SOUTH
(2, 506.0)	(3, 759.0)	(4, 937.0)	(5, 1077.0)	(6, 1194.0)	(7, 1294.0)	(8, 1383.0)	(9, 1461.0)	(10, 1532.0)	(11, 1597.0)	(12, 1657.0)	(13, 1712.0)	(14, 1763.0)	(15, 1810.0)	(16, 1855.0)	(17, 1897.0)	(18, 1937.0)	(19, 1974.0)	(20, 2010.0)	(21, 2044.0)	(22, 2077.0)	(23, 2108.0)	(24, 2137.0)	(25, 2166.0)	(26, 2193.0)	(27, 2219.0)	(28, 2245.0)	(29, 2269.0)	(30, 2293.0)	(31, 2315.0)	(32, 2337.0)	(33, 2359.0)	(34, 2379.0)	(35, 2399.0)	(36, 2419.0)	(37, 2438.0)	(38, 2456.0)	(39, 2474.0)	(40, 2491.0)	(41, 2508.0)	(42, 2525.0)	(43, 2541.0)	(44, 2556.0)	(45, 2572.0)	(46, 2587.0)	(47, 2601.0)	(48, 2616.0)	(49, 2630.0)	(50, 2643.0)	(51, 2657.0)	(52, 2670.0)	(53, 2683.0)	(54, 2695.0)	(55, 2707.0)	(56, 2720.0)	(57, 2731.0)	(58, 2743.0)	(59, 2754.0)	(60, 2766.0)	(61, 2777.0)	(62, 2787.0)	(63, 2798.0)	(64, 2808.0)	(65, 2818.0)	(66, 2828.0)	(67, 2838.0)	(68, 2847.0)	(69, 2857.0)	(70, 2866.0)	(71, 2875.0)	(72, 2885.0)	(73, 2891.0)	(74, 2900.0)	(75, 2907.0)	(76, 2915.0)	(77, 2924.0)	(78, 2932.0)	(79, 2934.0)	(80, 2942.0)	(81, 2949.0)	(82, 2957.0)	(83, 2962.0)	(84, 2969.0)	(85, 2973.0)	(86, 2980.0)	(87, 2981.0)	(88, 2988.0)	(89, 2988.0)	(90, 2995.0)	(91, 2997.0)	(92, 3004.0)	(93, 3004.0)	(94, 3011.0)	(95, 3011.0)	(96, 3018.0)	(97, 3016.0)	(98, 3022.0)	(99, 3013.0)	(100, 3019.0)	(101, 3004.0)	(102, 3010.0)	(103, 3002.0)	(104, 3007.0)	(105, 3002.0)	(106, 3007.0)	(107, 2995.0)	(108, 3000.0)	(109, 2984.0)	(110, 2990.0)	(111, 2982.0)	(112, 2987.0)	(113, 2970.0)	(114, 2975.0)	(115, 2956.0)	(116, 2960.0)	(117, 2933.0)	(118, 2938.0)	(119, 2916.0)	(120, 2921.0)	(121, 2900.0)	(122, 2905.0)	(123, 2885.0)	(124, 2890.0)	(125, 2875.0)	(126, 2879.0)	(127, 2857.0)	(128, 2861.0)	(129, 2839.0)	(130, 2843.0)	(131, 2820.0)	(132, 2824.0)	(133, 2801.0)	(134, 2805.0)	(135, 2782.0)	(136, 2785.0)	(137, 2753.0)	(138, 2757.0)	(139, 2730.0)	(140, 2734.0)	(141, 2710.0)	(142, 2714.0)	(143, 2685.0)	(144, 2689.0)	(145, 2670.0)	(146, 2673.0)	(147, 2641.0)	(148, 2644.0)	(149, 2614.0)	(150, 2617.0)	(151, 2589.0)	(152, 2592.0)	(153, 2559.0)	(154, 2562.0)	(155, 2515.0)	(156, 2518.0)	(157, 2483.0)	(158, 2486.0)	(159, 2445.0)	(160, 2447.0)	(161, 2408.0)	(162, 2411.0)	(163, 2363.0)	(164, 2366.0)	(165, 2322.0)	(166, 2325.0)	(167, 2274.0)	(168, 2277.0)	(169, 2237.0)	(170, 2239.0)	(171, 2189.0)	(172, 2191.0)	(173, 2139.0)	(174, 2141.0)	(175, 2077.0)	(176, 2079.0)	(177, 1996.0)	(178, 1998.0)	(179, 1910.0)	(180, 1911.0)	(181, 1814.0)	(182, 1816.0)	(183, 1724.0)	(184, 1725.0)	(185, 1620.0)	(186, 1622.0)	(187, 1483.0)	(188, 1485.0)	(189, 1309.0)	(190, 1310.0)	(191, 1114.0)	(192, 1116.0)	(193, 830.0)	(194, 831.0)	(195, 341.0)	(196, 341.0)	


FOR
(2, 485.0)	(3, 727.0)	(4, 891.0)	(5, 1015.0)	(6, 1115.0)	(7, 1198.0)	(8, 1269.0)	(9, 1327.0)	(10, 1382.0)	(11, 1416.0)	(12, 1459.0)	(13, 1470.0)	(14, 1506.0)	(15, 1499.0)	(16, 1529.0)	(17, 1483.0)	(18, 1508.0)	(19, 1463.0)	(20, 1484.0)	(21, 1415.0)	(22, 1433.0)	(23, 1345.0)	(24, 1360.0)	(25, 1271.0)	(26, 1284.0)	(27, 1200.0)	(28, 1211.0)	(29, 1115.0)	(30, 1124.0)	(31, 1005.0)	(32, 1013.0)	(33, 879.0)	(34, 885.0)	(35, 727.0)	(36, 732.0)	(37, 537.0)	(38, 540.0)	(39, 317.0)	(40, 319.0)	


HOD
(2, 494.0)	(3, 742.0)	(4, 912.0)	(5, 1043.0)	(6, 1151.0)	(7, 1242.0)	(8, 1320.0)	(9, 1389.0)	(10, 1451.0)	(11, 1506.0)	(12, 1556.0)	(13, 1602.0)	(14, 1644.0)	(15, 1682.0)	(16, 1718.0)	(17, 1749.0)	(18, 1780.0)	(19, 1806.0)	(20, 1834.0)	(21, 1856.0)	(22, 1880.0)	(23, 1895.0)	(24, 1917.0)	(25, 1922.0)	(26, 1941.0)	(27, 1942.0)	(28, 1959.0)	(29, 1946.0)	(30, 1962.0)	(31, 1944.0)	(32, 1958.0)	(33, 1931.0)	(34, 1944.0)	(35, 1917.0)	(36, 1929.0)	(37, 1870.0)	(38, 1881.0)	(39, 1839.0)	(40, 1849.0)	(41, 1793.0)	(42, 1802.0)	(43, 1736.0)	(44, 1745.0)	(45, 1667.0)	(46, 1675.0)	(47, 1591.0)	(48, 1598.0)	(49, 1500.0)	(50, 1506.0)	(51, 1393.0)	(52, 1398.0)	(53, 1276.0)	(54, 1281.0)	(55, 1136.0)	(56, 1140.0)	(57, 937.0)	(58, 940.0)	(59, 644.0)	(60, 646.0)	


```

Use the same projections as before, and 108 for NEW

```
./easySFS.py -i ~/1a_Aricia_agestis_PopGenomics/FINAL_VCF/AA261.FSCinput.recode.vcf -p FullModel.popinput --proj 108,83,16,28 -o FullModel --prefix FullModel -f
Processing 4 populations - odict_keys(['NEW', 'SOUTH', 'FOR', 'HOD'])
  Sampling one snp per locus
Doing 1D sfs - NEW
Doing 1D sfs - SOUTH
Doing 1D sfs - FOR
Doing 1D sfs - HOD
Doing 2D sfs - ('NEW', 'SOUTH')
Doing 2D sfs - ('NEW', 'FOR')
Doing 2D sfs - ('NEW', 'HOD')
Doing 2D sfs - ('SOUTH', 'FOR')
Doing 2D sfs - ('SOUTH', 'HOD')
Doing 2D sfs - ('FOR', 'HOD')
Doing multiSFS for all pops

```



## FINAL MODEL - NO FOR

We realised that Fordon (FOR) is likely a new population, so we need to rerun the models. We've decided to exclude FOR entirely. So the new test with be between HOD and SOUTH as the origin of the new populations. 

All analyses run on the server
```
pwd
/newhome/aj18951/1a_Aricia_agestis_PopGenomics/FastSimCoal/GENERATE_INPUT/easySFS
```

input pop file just excludes FOR: 
```
head FullModelNOFOR.popinput 
BAR_10_2013_R1_.fastq.gz	NEW
BAR_11_2014_R1_.fastq.gz	NEW
BAR_12_2013_R1_.fastq.gz	NEW
BAR_13_2014_R1_.fastq.gz	NEW
BAR_14_2013_R1_.fastq.gz	NEW
BAR_14_2014_R1_.fastq.gz	NEW
BAR_15_2014_R1_.fastq.gz	NEW
BAR_17_2014_R1_.fastq.gz	NEW
BAR_18_2014_R1_.fastq.gz	NEW
BAR_20_2014_R1_.fastq.gz	NEW
```

FOR needs to be filtered from the input vcf file: 
```
module load apps/vcftools-0.1.12b
module load apps/bcftools-1.8
bcftools query -l ../../../FINAL_VCF/AA261.FSCinput.recode.vcf
##copy all the FOR samle names and paste into doc:
nano FOR.names

vcftools --vcf ../../../FINAL_VCF/AA261.FSCinput.recode.vcf --remove FOR.names --recode --recode-INFO-all --out AA241.FSCinput

VCFtools - v0.1.12b
(C) Adam Auton and Anthony Marcketta 2009

Parameters as interpreted:
	--vcf ../../../FINAL_VCF/AA261.FSCinput.recode.vcf
	--exclude FOR.names
	--recode-INFO-all
	--out AA241.FSCinput
	--recode

Excluding individuals in 'exclude' list
After filtering, kept 241 out of 261 Individuals
Outputting VCF file...
After filtering, kept 58483 out of a possible 58483 Sites
Run Time = 35.00 seconds
```

Run easySFS in --preview mode: 
```
/newhome/aj18951/1a_Aricia_agestis_PopGenomics/FastSimCoal/GENERATE_INPUT/easySFS
conda activate easySFS

./easySFS.py -i ../../../FINAL_VCF/AA241.FSCinput.recode.vcf -p FullModelNOFOR.popinput --preview


Processing 3 populations - odict_keys(['NEW', 'SOUTH', 'HOD'])
  Sampling one snp per locus

    Running preview mode. We will print out the results for # of segregating sites
    for multiple values of projecting down for each population. The dadi
    manual recommends maximizing the # of seg sites for projections, but also
    a balance must be struck between # of seg sites and sample size.

    For each population you should choose the value of the projection that looks
    best and then rerun easySFS with the `--proj` flag.
    
NEW
(2, 475.0)	(3, 713.0)	(4, 875.0)	(5, 1000.0)	(6, 1102.0)	(7, 1188.0)	(8, 1263.0)	(9, 1328.0)	(10, 1387.0)	(11, 1439.0)	(12, 1487.0)	(13, 1531.0)	(14, 1572.0)	(15, 1609.0)	(16, 1644.0)	(17, 1677.0)	(18, 1708.0)	(19, 1737.0)	(20, 1764.0)	(21, 1790.0)	(22, 1814.0)	(23, 1838.0)	(24, 1860.0)	(25, 1881.0)	(26, 1902.0)	(27, 1921.0)	(28, 1940.0)	(29, 1958.0)	(30, 1976.0)	(31, 1992.0)	(32, 2009.0)	(33, 2024.0)	(34, 2039.0)	(35, 2054.0)	(36, 2068.0)	(37, 2082.0)	(38, 2095.0)	(39, 2108.0)	(40, 2121.0)	(41, 2133.0)	(42, 2145.0)	(43, 2157.0)	(44, 2168.0)	(45, 2179.0)	(46, 2190.0)	(47, 2201.0)	(48, 2211.0)	(49, 2221.0)	(50, 2231.0)	(51, 2240.0)	(52, 2249.0)	(53, 2259.0)	(54, 2268.0)	(55, 2276.0)	(56, 2285.0)	(57, 2293.0)	(58, 2301.0)	(59, 2310.0)	(60, 2317.0)	(61, 2325.0)	(62, 2333.0)	(63, 2340.0)	(64, 2348.0)	(65, 2355.0)	(66, 2362.0)	(67, 2369.0)	(68, 2376.0)	(69, 2382.0)	(70, 2389.0)	(71, 2395.0)	(72, 2402.0)	(73, 2408.0)	(74, 2414.0)	(75, 2420.0)	(76, 2426.0)	(77, 2432.0)	(78, 2438.0)	(79, 2443.0)	(80, 2449.0)	(81, 2454.0)	(82, 2460.0)	(83, 2465.0)	(84, 2470.0)	(85, 2474.0)	(86, 2479.0)	(87, 2483.0)	(88, 2488.0)	(89, 2492.0)	(90, 2497.0)	(91, 2501.0)	(92, 2505.0)	(93, 2510.0)	(94, 2515.0)	(95, 2519.0)	(96, 2524.0)	(97, 2528.0)	(98, 2532.0)	(99, 2535.0)	(100, 2540.0)	(101, 2543.0)	(102, 2547.0)	(103, 2547.0)	(104, 2551.0)	(105, 2551.0)	(106, 2555.0)	(107, 2549.0)	(108, 2553.0)	(109, 2553.0)	(110, 2557.0)	(111, 2551.0)	(112, 2555.0)	(113, 2549.0)	(114, 2553.0)	(115, 2546.0)	(116, 2550.0)	(117, 2539.0)	(118, 2542.0)	(119, 2539.0)	(120, 2542.0)	(121, 2531.0)	(122, 2534.0)	(123, 2527.0)	(124, 2530.0)	(125, 2521.0)	(126, 2524.0)	(127, 2509.0)	(128, 2512.0)	(129, 2505.0)	(130, 2508.0)	(131, 2496.0)	(132, 2499.0)	(133, 2485.0)	(134, 2487.0)	(135, 2477.0)	(136, 2480.0)	(137, 2463.0)	(138, 2466.0)	(139, 2451.0)	(140, 2454.0)	(141, 2438.0)	(142, 2441.0)	(143, 2417.0)	(144, 2420.0)	(145, 2410.0)	(146, 2412.0)	(147, 2397.0)	(148, 2399.0)	(149, 2377.0)	(150, 2380.0)	(151, 2359.0)	(152, 2361.0)	(153, 2330.0)	(154, 2332.0)	(155, 2308.0)	(156, 2310.0)	(157, 2294.0)	(158, 2296.0)	(159, 2287.0)	(160, 2289.0)	(161, 2268.0)	(162, 2270.0)	(163, 2256.0)	(164, 2258.0)	(165, 2235.0)	(166, 2237.0)	(167, 2223.0)	(168, 2225.0)	(169, 2206.0)	(170, 2208.0)	(171, 2186.0)	(172, 2188.0)	(173, 2157.0)	(174, 2158.0)	(175, 2135.0)	(176, 2137.0)	(177, 2114.0)	(178, 2116.0)	(179, 2088.0)	(180, 2089.0)	(181, 2062.0)	(182, 2063.0)	(183, 2037.0)	(184, 2039.0)	(185, 2004.0)	(186, 2006.0)	(187, 1986.0)	(188, 1988.0)	(189, 1962.0)	(190, 1963.0)	(191, 1936.0)	(192, 1937.0)	(193, 1908.0)	(194, 1909.0)	(195, 1869.0)	(196, 1871.0)	(197, 1830.0)	(198, 1831.0)	(199, 1792.0)	(200, 1793.0)	(201, 1740.0)	(202, 1741.0)	(203, 1701.0)	(204, 1703.0)	(205, 1635.0)	(206, 1636.0)	(207, 1584.0)	(208, 1585.0)	(209, 1523.0)	(210, 1524.0)	(211, 1454.0)	(212, 1455.0)	(213, 1384.0)	(214, 1385.0)	(215, 1319.0)	(216, 1320.0)	(217, 1228.0)	(218, 1229.0)	(219, 1143.0)	(220, 1143.0)	(221, 1006.0)	(222, 1007.0)	(223, 807.0)	(224, 808.0)	(225, 303.0)	(226, 303.0)	


SOUTH
(2, 508.0)	(3, 762.0)	(4, 941.0)	(5, 1083.0)	(6, 1201.0)	(7, 1303.0)	(8, 1393.0)	(9, 1473.0)	(10, 1546.0)	(11, 1612.0)	(12, 1673.0)	(13, 1730.0)	(14, 1782.0)	(15, 1832.0)	(16, 1878.0)	(17, 1921.0)	(18, 1962.0)	(19, 2001.0)	(20, 2038.0)	(21, 2073.0)	(22, 2107.0)	(23, 2139.0)	(24, 2170.0)	(25, 2199.0)	(26, 2227.0)	(27, 2254.0)	(28, 2280.0)	(29, 2306.0)	(30, 2330.0)	(31, 2354.0)	(32, 2376.0)	(33, 2398.0)	(34, 2420.0)	(35, 2440.0)	(36, 2460.0)	(37, 2480.0)	(38, 2499.0)	(39, 2517.0)	(40, 2535.0)	(41, 2552.0)	(42, 2569.0)	(43, 2586.0)	(44, 2602.0)	(45, 2618.0)	(46, 2633.0)	(47, 2648.0)	(48, 2663.0)	(49, 2677.0)	(50, 2691.0)	(51, 2705.0)	(52, 2718.0)	(53, 2731.0)	(54, 2744.0)	(55, 2757.0)	(56, 2769.0)	(57, 2781.0)	(58, 2793.0)	(59, 2805.0)	(60, 2816.0)	(61, 2827.0)	(62, 2838.0)	(63, 2849.0)	(64, 2860.0)	(65, 2869.0)	(66, 2879.0)	(67, 2890.0)	(68, 2899.0)	(69, 2909.0)	(70, 2919.0)	(71, 2928.0)	(72, 2937.0)	(73, 2945.0)	(74, 2954.0)	(75, 2961.0)	(76, 2970.0)	(77, 2977.0)	(78, 2986.0)	(79, 2988.0)	(80, 2996.0)	(81, 3002.0)	(82, 3010.0)	(83, 3014.0)	(84, 3021.0)	(85, 3028.0)	(86, 3035.0)	(87, 3040.0)	(88, 3047.0)	(89, 3044.0)	(90, 3051.0)	(91, 3051.0)	(92, 3058.0)	(93, 3060.0)	(94, 3067.0)	(95, 3062.0)	(96, 3068.0)	(97, 3063.0)	(98, 3070.0)	(99, 3064.0)	(100, 3070.0)	(101, 3058.0)	(102, 3064.0)	(103, 3055.0)	(104, 3061.0)	(105, 3053.0)	(106, 3058.0)	(107, 3049.0)	(108, 3054.0)	(109, 3037.0)	(110, 3042.0)	(111, 3035.0)	(112, 3040.0)	(113, 3022.0)	(114, 3027.0)	(115, 3011.0)	(116, 3016.0)	(117, 2999.0)	(118, 3004.0)	(119, 2983.0)	(120, 2988.0)	(121, 2963.0)	(122, 2968.0)	(123, 2948.0)	(124, 2953.0)	(125, 2928.0)	(126, 2933.0)	(127, 2914.0)	(128, 2918.0)	(129, 2892.0)	(130, 2896.0)	(131, 2871.0)	(132, 2875.0)	(133, 2853.0)	(134, 2857.0)	(135, 2835.0)	(136, 2839.0)	(137, 2811.0)	(138, 2814.0)	(139, 2781.0)	(140, 2785.0)	(141, 2760.0)	(142, 2764.0)	(143, 2734.0)	(144, 2738.0)	(145, 2719.0)	(146, 2723.0)	(147, 2696.0)	(148, 2699.0)	(149, 2659.0)	(150, 2663.0)	(151, 2630.0)	(152, 2633.0)	(153, 2594.0)	(154, 2597.0)	(155, 2568.0)	(156, 2571.0)	(157, 2529.0)	(158, 2532.0)	(159, 2486.0)	(160, 2489.0)	(161, 2445.0)	(162, 2448.0)	(163, 2409.0)	(164, 2412.0)	(165, 2374.0)	(166, 2376.0)	(167, 2333.0)	(168, 2335.0)	(169, 2303.0)	(170, 2305.0)	(171, 2266.0)	(172, 2268.0)	(173, 2214.0)	(174, 2216.0)	(175, 2144.0)	(176, 2147.0)	(177, 2067.0)	(178, 2069.0)	(179, 1984.0)	(180, 1986.0)	(181, 1893.0)	(182, 1895.0)	(183, 1799.0)	(184, 1801.0)	(185, 1682.0)	(186, 1684.0)	(187, 1540.0)	(188, 1541.0)	(189, 1363.0)	(190, 1364.0)	(191, 1141.0)	(192, 1142.0)	(193, 845.0)	(194, 846.0)	(195, 367.0)	(196, 367.0)	


HOD
(2, 491.0)	(3, 736.0)	(4, 905.0)	(5, 1035.0)	(6, 1142.0)	(7, 1232.0)	(8, 1310.0)	(9, 1378.0)	(10, 1439.0)	(11, 1494.0)	(12, 1544.0)	(13, 1590.0)	(14, 1632.0)	(15, 1669.0)	(16, 1705.0)	(17, 1736.0)	(18, 1767.0)	(19, 1791.0)	(20, 1818.0)	(21, 1836.0)	(22, 1860.0)	(23, 1878.0)	(24, 1900.0)	(25, 1906.0)	(26, 1926.0)	(27, 1927.0)	(28, 1944.0)	(29, 1931.0)	(30, 1947.0)	(31, 1936.0)	(32, 1950.0)	(33, 1918.0)	(34, 1930.0)	(35, 1894.0)	(36, 1905.0)	(37, 1858.0)	(38, 1868.0)	(39, 1831.0)	(40, 1841.0)	(41, 1786.0)	(42, 1794.0)	(43, 1730.0)	(44, 1738.0)	(45, 1665.0)	(46, 1672.0)	(47, 1571.0)	(48, 1577.0)	(49, 1483.0)	(50, 1489.0)	(51, 1385.0)	(52, 1390.0)	(53, 1263.0)	(54, 1267.0)	(55, 1132.0)	(56, 1136.0)	(57, 931.0)	(58, 934.0)	(59, 643.0)	(60, 645.0)	
```


And choose the projections (same as before): 
```
./easySFS.py -i ~/1a_Aricia_agestis_PopGenomics/FINAL_VCF/AA241.FSCinput.recode.vcf -p FullModelNOFOR.popinput --proj 108,83,28 -o FINALModel --prefix FINALModel -f

Processing 3 populations - odict_keys(['NEW', 'SOUTH', 'HOD'])
  Sampling one snp per locus
Doing 1D sfs - NEW
Doing 1D sfs - SOUTH
Doing 1D sfs - HOD
Doing 2D sfs - ('NEW', 'SOUTH')
Doing 2D sfs - ('NEW', 'HOD')
Doing 2D sfs - ('SOUTH', 'HOD')
Doing multiSFS for all pops
```

